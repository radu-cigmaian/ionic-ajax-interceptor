!function(){"use strict";angular.module("ionic-ajax-interceptor",["ionic"])}(),function(t){"use strict";t.provider("AjaxInterceptor",["$httpProvider",function(t){var e={title:"Error",defaultMessage:"Unknown error",authorizationHeader:"Authorization",authorizationToken:null,stateChangeError:!0,fallbackIp:null,errHandler:{}};return{config:function(n){angular.extend(e,n),t.interceptors.push(["$rootScope","$q","$injector","Constants",function(t,n,r,o){return{request:function(n){return t.$broadcast("loading:show"),e.authorizationToken&&(n.headers[e.authorizationHeader]=e.authorizationToken),n.headers["App-Version"]=o.version,n},requestError:function(e){return t.$broadcast("loading:hide"),n.reject(e)},response:function(e){return t.$broadcast("loading:hide"),e},responseError:function(o){if(0==o.status){var a=o.config.url.split("/");if(a[2]!==e.fallbackIp){a[2]=e.fallbackIp,o.config.url=a.join("/");var i=r.get("$http");return i(o.config)}}return t.$broadcast("loading:hide"),e.errHandler[o.status]?(e.errHandler[o.status](o),{}):n.reject(o)}}}])},$get:["$ionicPopup","$ionicLoading","$rootScope",function(t,n,r){var o=0,a=function(){0===o&&n.show({content:"Loading",animation:"fade-in",showBackdrop:!1,maxWidth:200,showDelay:0}),o++},i=function(){o--,0==o?n.hide():o<0&&(o=0)};return{run:function(){e.stateChangeError&&r.$on("$stateChangeError",function(n,r,o,a,i,c){t.alert({title:e.title,content:c.message||e.defaultMessage})}),r.$on("loading:show",function(){a()}),r.$on("loading:hide",function(){i()})},setErrorHandler:function(t){e.errHandler=t},setAuthorizationToken:function(t){e.authorizationToken=t},getAuthorizationToken:function(){return e.authorizationToken},showLoading:function(){a()},hideLoading:function(){i()}}}]}}])}(angular.module("ionic-ajax-interceptor")),function(t){"use strict";var e="iHttp_";t.factory("AjaxService",["$http","$q",function(t,n){return{config:function(t){t.hasOwnProperty(prefix)&&(e=t.prefix)},http:function(r){var o,a;if(r.iCache){o=e,a=r.iCache.expires,o+=r.iCache.hasOwnProperty("key")?r.iCache.key:r.url;var i=localStorage.getItem(o);if(i){var c=JSON.parse(i);if(!c.timestamp||c.timestamp>(new Date).getTime())return n.resolve({data:c.data})}delete r.iCache}var u=n.defer();return t(r).then(function(t){if(o&&t.data){var e=JSON.stringify({timestamp:a,data:t.data});localStorage.setItem(o,e)}u.resolve(t)},function(t){u.reject(t)}),u.promise},clearCache:function(){for(var t in localStorage)localStorage.hasOwnProperty(t)&&0==t.indexOf(e)&&localStorage.removeItem(t)}}}])}(angular.module("ionic-ajax-interceptor"));