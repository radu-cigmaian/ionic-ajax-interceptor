!function(){"use strict";angular.module("ionic-ajax-interceptor",["ionic"])}(),function(){"use strict";angular.module("ionic-ajax-interceptor",["ionic"])}(),function(t){"use strict";t.provider("AjaxInterceptor",["$httpProvider",function(t){var e={title:"Error",defaultMessage:"Unknown error",authorizationHeader:"Authorization",authorizationToken:null,stateChangeError:!0,fallbackIp:null,errHandler:{}};return{config:function(n){angular.extend(e,n),t.interceptors.push(["$rootScope","$q","$injector","Constants",function(t,n,r,a){return{request:function(n){return t.$broadcast("loading:show"),e.authorizationToken&&(n.headers[e.authorizationHeader]=e.authorizationToken),n.headers["App-Version"]=a.version,n},requestError:function(e){return t.$broadcast("loading:hide"),n.reject(e)},response:function(e){return t.$broadcast("loading:hide"),e},responseError:function(a){if(t.$broadcast("loading:hide"),0==a.status||a.status==-1||a.status>=500){var o=a.config.url.split("/");o[2]!=e.fallbackIp?(o[2]=e.fallbackIp,e.svdUrl=a.config.url,a.config.url=o.join("/")):(a.config.url=e.svdUrl,Number(a.status)<500?alert("Va rugam verificati conexiunea la internet, aplicatia nu s-a putut conecta la server."):alert("Va rugam verificati conexiunea la internet, aplicatia nu s-a putut conecta la server. \nStatus:"+a.status));var i=r.get("$http");return i(a.config)}return e.errHandler[a.status]?(e.errHandler[a.status](a),{}):n.reject(a)}}}])},$get:["$ionicPopup","$ionicLoading","$rootScope",function(t,n,r){var a=0,o=function(){0===a&&n.show({content:"Loading",animation:"fade-in",showBackdrop:!1,maxWidth:200,showDelay:0}),a++},i=function(){a--,0==a?n.hide():a<0&&(a=0)};return{run:function(){e.stateChangeError&&r.$on("$stateChangeError",function(n,r,a,o,i,u){t.alert({title:e.title,content:u.message||e.defaultMessage})}),r.$on("loading:show",function(){o()}),r.$on("loading:hide",function(){i()})},setErrorHandler:function(t){e.errHandler=t},setAuthorizationToken:function(t){e.authorizationToken=t},getAuthorizationToken:function(){return e.authorizationToken},showLoading:function(){o()},hideLoading:function(){i()}}}]}}])}(angular.module("ionic-ajax-interceptor")),function(t){"use strict";var e="iHttp_";t.factory("AjaxService",["$http","$q",function(t,n){return{config:function(t){t.hasOwnProperty(prefix)&&(e=t.prefix)},http:function(r){var a,o;if(r.iCache){a=e,o=r.iCache.expires,a+=r.iCache.hasOwnProperty("key")?r.iCache.key:r.url;var i=localStorage.getItem(a);if(i){var u=JSON.parse(i);if(!u.timestamp||u.timestamp>(new Date).getTime())return n.resolve({data:u.data})}delete r.iCache}var c=n.defer();return t(r).then(function(t){if(a&&t.data){var e=JSON.stringify({timestamp:o,data:t.data});localStorage.setItem(a,e)}c.resolve(t)},function(t){c.reject(t)}),c.promise},clearCache:function(){for(var t in localStorage)localStorage.hasOwnProperty(t)&&0==t.indexOf(e)&&localStorage.removeItem(t)}}}])}(angular.module("ionic-ajax-interceptor"));